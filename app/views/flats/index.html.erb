<div class="card-flats">
	<h1>
		<i class="fas fa-building"></i> 
		My flats near <i class="fas fa-map-marker-alt small"></i> <strong>Lyon</strong>
		<span class="badge badge-pill badge-primary"><%= current_user.flats.count %></span>
	</h1>

	<ul class="list-group list-group-flush">
	<% @flats.each do |flat| %>
		<li class="list-group-item d-flex justify-content-between">
			<%= short_text(flat.address) %>
			<div class="actions">
				<%# TO RENT BUTTON %>
				<% if flat.pending_rental? %>
					<%= flat.has_visits? ? "V" : "" %>
					<% bagde_class = flat.num_candidates == 0 ? 'danger' : 'info' %>
					<%= link_to raw(bagde(pluralize(flat.num_candidates, 'candidate'), bagde_class, 'street-view', flat_rental_path(flat, flat.pending_rental_id))) %>
				<% else %>
					<% badge_class = flat.to_rent ? 'danger' : 'warning' %>
					<%= link_to raw(badge('New rental', badge_class, 'file-import', new_flat_rental_path(flat.id))) %>
				<% end %>
				<%# DETAILS BUTTON %>
				<%= link_to raw(badge('Details', 'primary', 'info', flat_path(flat.id))) %>
			</div>
		</li>
	<% end %>
	</ul>
</div>

<%# MAPBOX %>
<div id="map" style="width: 100%; height: 100vh;" data-markers="<%= @markers.to_json %>" data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"></div>
