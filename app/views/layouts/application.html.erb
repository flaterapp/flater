<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- META TAGS - Title -->
    <!-- old version -->
    <title>Flater&trade; &centerdot; Select, rent & chill!</title>
    <!-- new version -->
    <title><%= meta_title %></title>
    
    <!-- initial tags -->
    <%= csrf_meta_tags %>
    <%= action_cable_meta_tag %>

    <!-- Social networks tags - to be finalized -->
    
    <!-- Facebook Open Graph data -->
    <meta property="og:title" content="<%= meta_title %>" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="<%= request.original_url %>" />
    <meta property="og:image" content="<%= meta_image %>" />
    <meta property="og:description" content="<%= meta_description %>" />
    <meta property="og:site_name" content="<%= meta_title %>" />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="<%= DEFAULT_META["twitter_account"] %>">
    <meta name="twitter:title" content="<%= meta_title %>">
    <meta name="twitter:description" content="<%= meta_description %>">
    <meta name="twitter:creator" content="<%= DEFAULT_META["twitter_account"] %>">
    <meta name="twitter:image:src" content="<%= meta_image %>">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <%= stylesheet_link_tag 'application', media: 'all' %>
    <%= stylesheet_pack_tag 'application', media: 'all' %> <!-- Uncomment if you import CSS in app/javascript/packs/application.js -->
  </head>

  <body>
    <div class="bs-canvas-overlay bg-dark position-fixed w-100 h-100"></div>

    <%# NAVBAR %>
    <%= render 'layouts/shared/navbar' %>

   <%# CONTENT %>
    <%= yield %>

    <%# FOOTER %>
    <%= render 'layouts/shared/footer' %>

    <%# SIDEBAR %>
    <%= render 'layouts/shared/sidebar' %>

    <%# DEVISE NOTIFICATIONS %>
    <%= raw("<p class=\"alert alert-primary\">#{notice}</p>") if notice %>
    <%= raw("<p class=\"alert alert-danger\">#{alert}</p>") if alert %>

    <%# ASYNC JS %>
    <%= javascript_include_tag 'application' %>
    <%= javascript_pack_tag 'application' %>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.9"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <%# OPTIMIZE Refactor JQuery sidebar menu %>
    <script>
      jQuery(document).ready(function($){
        var bsOverlay = $('.bs-canvas-overlay');
        $('[data-toggle="canvas"]').on('click', function(){
          var ctrl = $(this),
            elm = ctrl.is('button') ? ctrl.data('target') : ctrl.attr('href');
          $(elm).addClass('mr-0');
          $(elm + ' .bs-canvas-close').attr('aria-expanded', "true");
          $('[data-target="' + elm + '"], a[href="' + elm + '"]').attr('aria-expanded', "true");
          if(bsOverlay.length)
            bsOverlay.addClass('show');
          return false;
        });

        $('.bs-canvas-close, .bs-canvas-overlay').on('click', function(){
          var elm;
          if($(this).hasClass('bs-canvas-close')) {
            elm = $(this).closest('.bs-canvas');
            $('[data-target="' + elm + '"], a[href="' + elm + '"]').attr('aria-expanded', "false");
          } else {
            elm = $('.bs-canvas')
            $('[data-toggle="canvas"]').attr('aria-expanded', "false");
          }
          elm.removeClass('mr-0');
          $('.bs-canvas-close', elm).attr('aria-expanded', "false");
          if(bsOverlay.length)
            bsOverlay.removeClass('show');
          return false;
        });
      });
    </script>
  </body>
</html>
